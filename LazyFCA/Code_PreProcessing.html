
<pre style="color:#000000;background:#ffffff;"><span style="color:#800000; font-weight:bold; ">import</span> pandas <span style="color:#800000; font-weight:bold; ">as</span> pd
<span style="color:#800000; font-weight:bold; ">import</span> numpy <span style="color:#800000; font-weight:bold; ">as</span> np
<span style="color:#696969; ">#User Settings</span>
training_set <span style="color:#808030; ">=</span> <span style="color:#008000; ">0.7</span>
show_descriptive_statistics <span style="color:#808030; ">=</span> <span style="color:#074726; ">True</span>
num_cross_validations <span style="color:#808030; ">=</span> <span style="color:#008c00; ">10</span>

<span style="color:#696969; ">#Drops empty rows from IPEDS and creates test and train sets</span>
attribute_names<span style="color:#808030; ">=</span><span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Name'</span><span style="color:#808030; ">,</span><span style="color:#0000e6; ">'Percent admitted - total'</span><span style="color:#808030; ">,</span><span style="color:#0000e6; ">'Total price for out-of-state students living on campus 2013-14'</span><span style="color:#808030; ">,</span>
                 <span style="color:#0000e6; ">'Geographic region'</span><span style="color:#808030; ">,</span><span style="color:#0000e6; ">'Estimated undergraduate enrollment total'</span><span style="color:#808030; ">,</span><span style="color:#0000e6; ">'Sector of institution'</span><span style="color:#808030; ">,</span>
                 <span style="color:#0000e6; ">'Percent of freshmen receiving any financial aid'</span><span style="color:#808030; ">,</span><span style="color:#0000e6; ">'Percent of freshmen receiving Pell grants'</span><span style="color:#808030; ">]</span>


<span style="color:#696969; ">#Initial data set has 1534 objects</span>
data <span style="color:#808030; ">=</span> pd<span style="color:#808030; ">.</span>read_csv<span style="color:#808030; ">(</span><span style="color:#0000e6; ">"IPEDS_Simple.csv"</span><span style="color:#808030; ">)</span>
data<span style="color:#808030; ">.</span>replace<span style="color:#808030; ">(</span><span style="color:#0000e6; ">''</span><span style="color:#808030; ">,</span> np<span style="color:#808030; ">.</span>nan<span style="color:#808030; ">,</span> inplace<span style="color:#808030; ">=</span><span style="color:#074726; ">True</span><span style="color:#808030; ">)</span>
data<span style="color:#808030; ">.</span>dropna<span style="color:#808030; ">(</span>inplace<span style="color:#808030; ">=</span><span style="color:#074726; ">True</span><span style="color:#808030; ">)</span> <span style="color:#696969; ">#Completely drop anyone with any empty attributes (1326 results remain)</span>

<span style="color:#696969; ">#Next, we go about renaming our columns and data for reading and processing purpose</span>
data<span style="color:#808030; ">.</span>rename<span style="color:#808030; ">(</span>columns<span style="color:#808030; ">=</span><span style="color:#800080; ">{</span><span style="color:#0000e6; ">'Percent admitted - total'</span><span style="color:#808030; ">:</span><span style="color:#0000e6; ">'Percent Admitted'</span><span style="color:#808030; ">,</span>
                    <span style="color:#0000e6; ">'Total price for out-of-state students living on campus 2013-14'</span><span style="color:#808030; ">:</span><span style="color:#0000e6; ">'Price (OOS)'</span><span style="color:#808030; ">,</span>
                    <span style="color:#0000e6; ">'Geographic region'</span><span style="color:#808030; ">:</span><span style="color:#0000e6; ">'Region'</span><span style="color:#808030; ">,</span>
                    <span style="color:#0000e6; ">'Estimated undergraduate enrollment, total'</span><span style="color:#808030; ">:</span><span style="color:#0000e6; ">'Undergrad Enrollment'</span><span style="color:#808030; ">,</span>
                    <span style="color:#0000e6; ">'Sector of institution'</span><span style="color:#808030; ">:</span><span style="color:#0000e6; ">'Public'</span><span style="color:#808030; ">,</span>
                    <span style="color:#0000e6; ">'Percent of freshmen receiving any financial aid'</span><span style="color:#808030; ">:</span> <span style="color:#0000e6; ">'Financial Aid'</span><span style="color:#808030; ">,</span>
                    <span style="color:#0000e6; ">'Percent of freshmen receiving Pell grants'</span><span style="color:#808030; ">:</span> <span style="color:#0000e6; ">'Pell Grant'</span><span style="color:#800080; ">}</span><span style="color:#808030; ">,</span>inplace<span style="color:#808030; ">=</span><span style="color:#074726; ">True</span><span style="color:#808030; ">)</span>



<span style="color:#696969; ">#Public institutions = 1, Private Institutions = 0</span>
data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Public'</span><span style="color:#808030; ">]</span><span style="color:#808030; ">.</span>replace<span style="color:#808030; ">(</span><span style="color:#0000e6; ">'Public, 4-year or above'</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span> inplace<span style="color:#808030; ">=</span><span style="color:#074726; ">True</span><span style="color:#808030; ">)</span>
data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Public'</span><span style="color:#808030; ">]</span><span style="color:#808030; ">.</span>replace<span style="color:#808030; ">(</span><span style="color:#0000e6; ">'Private not-for-profit, 4-year or above'</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">0</span><span style="color:#808030; ">,</span> inplace<span style="color:#808030; ">=</span><span style="color:#074726; ">True</span><span style="color:#808030; ">)</span>

region_SE <span style="color:#808030; ">=</span> <span style="color:#0000e6; ">'Southeast AL AR FL GA KY LA MS NC SC TN VA WV'</span>
region_W <span style="color:#808030; ">=</span> <span style="color:#0000e6; ">'Far West AK CA HI NV OR WA'</span>
region_SW <span style="color:#808030; ">=</span> <span style="color:#0000e6; ">'Southwest AZ NM OK TX'</span>
region_MNT <span style="color:#808030; ">=</span> <span style="color:#0000e6; ">'Rocky Mountains CO ID MT UT WY'</span>
region_NE <span style="color:#808030; ">=</span> <span style="color:#0000e6; ">'New England CT ME MA NH RI VT'</span>
region_ME <span style="color:#808030; ">=</span> <span style="color:#0000e6; ">'Mid East DE DC MD NJ NY PA'</span>
region_MW <span style="color:#808030; ">=</span> <span style="color:#0000e6; ">'Great Lakes IL IN MI OH WI'</span>
region_GP <span style="color:#808030; ">=</span> <span style="color:#0000e6; ">'Plains IA KS MN MO NE ND SD'</span>

<span style="color:#800000; font-weight:bold; ">if</span> show_descriptive_statistics<span style="color:#808030; ">:</span>
    <span style="color:#696969; ">#Quick reference: 1QR,2QR,3QR</span>
    <span style="color:#800000; font-weight:bold; ">print</span> data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Percent Admitted'</span><span style="color:#808030; ">]</span><span style="color:#808030; ">.</span>describe<span style="color:#808030; ">(</span><span style="color:#808030; ">)</span> <span style="color:#696969; ">#54,66,77</span>
    <span style="color:#800000; font-weight:bold; ">print</span> data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Price (OOS)'</span><span style="color:#808030; ">]</span><span style="color:#808030; ">.</span>describe<span style="color:#808030; ">(</span><span style="color:#808030; ">)</span> <span style="color:#696969; ">#31842,37902,46323</span>
    <span style="color:#800000; font-weight:bold; ">print</span> data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Undergrad Enrollment'</span><span style="color:#808030; ">]</span><span style="color:#808030; ">.</span>describe<span style="color:#808030; ">(</span><span style="color:#808030; ">)</span> <span style="color:#696969; ">#1476,2687,6844</span>
    <span style="color:#800000; font-weight:bold; ">print</span> data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Financial Aid'</span><span style="color:#808030; ">]</span><span style="color:#808030; ">.</span>describe<span style="color:#808030; ">(</span><span style="color:#808030; ">)</span> <span style="color:#696969; ">#87,96,99</span>
    <span style="color:#800000; font-weight:bold; ">print</span> data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Pell Grant'</span><span style="color:#808030; ">]</span><span style="color:#808030; ">.</span>describe<span style="color:#808030; ">(</span><span style="color:#808030; ">)</span> <span style="color:#696969; ">#26,37,48</span>
    <span style="color:#800000; font-weight:bold; ">print</span> data<span style="color:#808030; ">.</span>groupby<span style="color:#808030; ">(</span><span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Region'</span><span style="color:#808030; ">]</span><span style="color:#808030; ">)</span><span style="color:#808030; ">.</span>size<span style="color:#808030; ">(</span><span style="color:#808030; ">)</span>
    <span style="color:#800000; font-weight:bold; ">print</span> data<span style="color:#808030; ">.</span>groupby<span style="color:#808030; ">(</span><span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Public'</span><span style="color:#808030; ">]</span><span style="color:#808030; ">)</span><span style="color:#808030; ">.</span>size<span style="color:#808030; ">(</span><span style="color:#808030; ">)</span>


<span style="color:#696969; ">#Here we print our intermediate result</span>
data<span style="color:#808030; ">.</span>to_csv<span style="color:#808030; ">(</span><span style="color:#0000e6; ">'IPEDS_Clean.csv'</span><span style="color:#808030; ">,</span>index<span style="color:#808030; ">=</span><span style="color:#074726; ">False</span><span style="color:#808030; ">)</span>

<span style="color:#696969; ">#And then we proceed to drop identifying information</span>
<span style="color:#800000; font-weight:bold; ">del</span> data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'ID number'</span><span style="color:#808030; ">]</span>
<span style="color:#800000; font-weight:bold; ">del</span> data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Name'</span><span style="color:#808030; ">]</span>

<span style="color:#696969; ">#Next, we have to classify each of the variables</span>
<span style="color:#696969; ">#Overall Settings</span>
split_price <span style="color:#808030; ">=</span> <span style="color:#008c00; ">38000</span>
split_admitted_1 <span style="color:#808030; ">=</span> <span style="color:#008c00; ">40</span> <span style="color:#696969; ">#Split on very selective schools</span>
split_admitted_2 <span style="color:#808030; ">=</span> <span style="color:#008c00; ">65</span>  <span style="color:#696969; ">#Split on selective schools</span>
split_enrollment_1 <span style="color:#808030; ">=</span> <span style="color:#008c00; ">1000</span> <span style="color:#696969; ">#Split on low enrollment schools</span>
split_financial_aid_1 <span style="color:#808030; ">=</span> <span style="color:#008c00; ">90</span> <span style="color:#696969; ">#Split on low financial aid</span>
split_pell_grant_1 <span style="color:#808030; ">=</span> <span style="color:#008c00; ">30</span> <span style="color:#696969; ">#Split pell grant low</span>
split_pell_grant_2 <span style="color:#808030; ">=</span> <span style="color:#008c00; ">45</span> <span style="color:#696969; ">#Split pell grant high</span>

<span style="color:#800000; font-weight:bold; ">if</span> show_descriptive_statistics<span style="color:#808030; ">:</span>
    less_than_split <span style="color:#808030; ">=</span> data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Price (OOS)'</span><span style="color:#808030; ">]</span> <span style="color:#44aadd; ">&lt;</span> split_price
    gte_split <span style="color:#808030; ">=</span> data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Price (OOS)'</span><span style="color:#808030; ">]</span> <span style="color:#44aadd; ">&gt;=</span> split_price
    less_than_pell_1 <span style="color:#808030; ">=</span> data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Pell Grant'</span><span style="color:#808030; ">]</span> <span style="color:#44aadd; ">&lt;</span> split_pell_grant_1
    gte_pell_1 <span style="color:#808030; ">=</span> data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Pell Grant'</span><span style="color:#808030; ">]</span> <span style="color:#44aadd; ">&gt;=</span> split_pell_grant_1

    <span style="color:#800000; font-weight:bold; ">print</span> data<span style="color:#808030; ">[</span>less_than_split<span style="color:#808030; ">]</span><span style="color:#808030; ">.</span>groupby<span style="color:#808030; ">(</span><span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Region'</span><span style="color:#808030; ">]</span><span style="color:#808030; ">)</span><span style="color:#808030; ">.</span>size<span style="color:#808030; ">(</span><span style="color:#808030; ">)</span>
    <span style="color:#800000; font-weight:bold; ">print</span> data<span style="color:#808030; ">[</span>gte_split<span style="color:#808030; ">]</span><span style="color:#808030; ">.</span>groupby<span style="color:#808030; ">(</span><span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Region'</span><span style="color:#808030; ">]</span><span style="color:#808030; ">)</span><span style="color:#808030; ">.</span>size<span style="color:#808030; ">(</span><span style="color:#808030; ">)</span>

    <span style="color:#800000; font-weight:bold; ">print</span> <span style="color:#400000; ">len</span><span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span>less_than_split<span style="color:#808030; ">]</span><span style="color:#808030; ">[</span>less_than_pell_1<span style="color:#808030; ">]</span><span style="color:#808030; ">)</span>
    <span style="color:#800000; font-weight:bold; ">print</span> <span style="color:#400000; ">len</span><span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span>gte_split<span style="color:#808030; ">]</span><span style="color:#808030; ">[</span>less_than_pell_1<span style="color:#808030; ">]</span><span style="color:#808030; ">)</span>
    <span style="color:#800000; font-weight:bold; ">print</span> <span style="color:#400000; ">len</span><span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span>less_than_split<span style="color:#808030; ">]</span><span style="color:#808030; ">[</span>gte_pell_1<span style="color:#808030; ">]</span><span style="color:#808030; ">)</span>
    <span style="color:#800000; font-weight:bold; ">print</span> <span style="color:#400000; ">len</span><span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span>gte_split<span style="color:#808030; ">]</span><span style="color:#808030; ">[</span>gte_pell_1<span style="color:#808030; ">]</span><span style="color:#808030; ">)</span>

<span style="color:#696969; ">#Public</span>
data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Private'</span><span style="color:#808030; ">]</span> <span style="color:#808030; ">=</span> np<span style="color:#808030; ">.</span>where<span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Public'</span><span style="color:#808030; ">]</span> <span style="color:#44aadd; ">==</span> <span style="color:#008c00; ">0</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">0</span><span style="color:#808030; ">)</span>
<span style="color:#696969; ">#del data['Public'] #no need to delete this one</span>

<span style="color:#696969; ">#Percent Admitted</span>
data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Very Selective Admissions'</span><span style="color:#808030; ">]</span> <span style="color:#808030; ">=</span> np<span style="color:#808030; ">.</span>where<span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Percent Admitted'</span><span style="color:#808030; ">]</span> <span style="color:#44aadd; ">&lt;</span> split_admitted_1<span style="color:#808030; ">,</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">0</span><span style="color:#808030; ">)</span>
data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Selective Admissions'</span><span style="color:#808030; ">]</span> <span style="color:#808030; ">=</span> np<span style="color:#808030; ">.</span>where<span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Percent Admitted'</span><span style="color:#808030; ">]</span> <span style="color:#44aadd; ">&lt;</span> split_admitted_2<span style="color:#808030; ">,</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">0</span><span style="color:#808030; ">)</span>
data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Regular Admissions'</span><span style="color:#808030; ">]</span> <span style="color:#808030; ">=</span> np<span style="color:#808030; ">.</span>where<span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Percent Admitted'</span><span style="color:#808030; ">]</span> <span style="color:#44aadd; ">&gt;=</span> split_admitted_2<span style="color:#808030; ">,</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">0</span><span style="color:#808030; ">)</span>
<span style="color:#800000; font-weight:bold; ">del</span> data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Percent Admitted'</span><span style="color:#808030; ">]</span>

<span style="color:#696969; ">#Region</span>
data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'New England'</span><span style="color:#808030; ">]</span> <span style="color:#808030; ">=</span> np<span style="color:#808030; ">.</span>where<span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Region'</span><span style="color:#808030; ">]</span> <span style="color:#44aadd; ">==</span> region_NE<span style="color:#808030; ">,</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">0</span><span style="color:#808030; ">)</span>
data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'West Coast'</span><span style="color:#808030; ">]</span> <span style="color:#808030; ">=</span> np<span style="color:#808030; ">.</span>where<span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Region'</span><span style="color:#808030; ">]</span> <span style="color:#44aadd; ">==</span> region_W<span style="color:#808030; ">,</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">0</span><span style="color:#808030; ">)</span>
data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Inland'</span><span style="color:#808030; ">]</span> <span style="color:#808030; ">=</span> np<span style="color:#808030; ">.</span>where<span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Region'</span><span style="color:#808030; ">]</span><span style="color:#808030; ">.</span>isin<span style="color:#808030; ">(</span><span style="color:#808030; ">[</span>region_MNT<span style="color:#808030; ">,</span>region_GP<span style="color:#808030; ">,</span> region_MW<span style="color:#808030; ">]</span><span style="color:#808030; ">)</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">0</span><span style="color:#808030; ">)</span>
data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'South and Southwest'</span><span style="color:#808030; ">]</span> <span style="color:#808030; ">=</span> np<span style="color:#808030; ">.</span>where<span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Region'</span><span style="color:#808030; ">]</span><span style="color:#808030; ">.</span>isin<span style="color:#808030; ">(</span><span style="color:#808030; ">[</span>region_SW<span style="color:#808030; ">,</span> region_SE<span style="color:#808030; ">]</span><span style="color:#808030; ">)</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">0</span><span style="color:#808030; ">)</span>
<span style="color:#800000; font-weight:bold; ">del</span> data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Region'</span><span style="color:#808030; ">]</span>
<span style="color:#696969; ">#Not split: SW, SE, ME</span>

<span style="color:#696969; ">#Undergrad Enrollment</span>
data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Small Enrollment'</span><span style="color:#808030; ">]</span> <span style="color:#808030; ">=</span> np<span style="color:#808030; ">.</span>where<span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Undergrad Enrollment'</span><span style="color:#808030; ">]</span> <span style="color:#44aadd; ">&lt;</span> split_enrollment_1<span style="color:#808030; ">,</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">0</span><span style="color:#808030; ">)</span>
data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Regular Enrollment'</span><span style="color:#808030; ">]</span> <span style="color:#808030; ">=</span> np<span style="color:#808030; ">.</span>where<span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Undergrad Enrollment'</span><span style="color:#808030; ">]</span> <span style="color:#44aadd; ">&gt;=</span> split_enrollment_1<span style="color:#808030; ">,</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">0</span><span style="color:#808030; ">)</span>
<span style="color:#800000; font-weight:bold; ">del</span> data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Undergrad Enrollment'</span><span style="color:#808030; ">]</span>

<span style="color:#696969; ">#Financial Aid</span>
data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Low Aid'</span><span style="color:#808030; ">]</span> <span style="color:#808030; ">=</span> np<span style="color:#808030; ">.</span>where<span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Financial Aid'</span><span style="color:#808030; ">]</span> <span style="color:#44aadd; ">&lt;</span> split_financial_aid_1<span style="color:#808030; ">,</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">0</span><span style="color:#808030; ">)</span>
data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Regular Aid'</span><span style="color:#808030; ">]</span> <span style="color:#808030; ">=</span> np<span style="color:#808030; ">.</span>where<span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Financial Aid'</span><span style="color:#808030; ">]</span> <span style="color:#44aadd; ">&gt;=</span> split_financial_aid_1<span style="color:#808030; ">,</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">0</span><span style="color:#808030; ">)</span>
<span style="color:#800000; font-weight:bold; ">del</span> data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Financial Aid'</span><span style="color:#808030; ">]</span>

<span style="color:#696969; ">#Pell Grant</span>
data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Low Pell'</span><span style="color:#808030; ">]</span> <span style="color:#808030; ">=</span> np<span style="color:#808030; ">.</span>where<span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Pell Grant'</span><span style="color:#808030; ">]</span> <span style="color:#44aadd; ">&lt;</span> split_pell_grant_1<span style="color:#808030; ">,</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">0</span><span style="color:#808030; ">)</span>
data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Medium Pell'</span><span style="color:#808030; ">]</span> <span style="color:#808030; ">=</span> np<span style="color:#808030; ">.</span>where<span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Pell Grant'</span><span style="color:#808030; ">]</span> <span style="color:#44aadd; ">&lt;</span> split_pell_grant_2<span style="color:#808030; ">,</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">0</span><span style="color:#808030; ">)</span>
data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'High Pell'</span><span style="color:#808030; ">]</span> <span style="color:#808030; ">=</span> np<span style="color:#808030; ">.</span>where<span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Pell Grant'</span><span style="color:#808030; ">]</span> <span style="color:#44aadd; ">&gt;=</span> split_pell_grant_2<span style="color:#808030; ">,</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span> <span style="color:#008c00; ">0</span><span style="color:#808030; ">)</span>
<span style="color:#800000; font-weight:bold; ">del</span> data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Pell Grant'</span><span style="color:#808030; ">]</span>

<span style="color:#696969; ">#Price (OOS) (target variable)</span>
<span style="color:#696969; ">#</span><span style="color:#ffffff; background:#808000; ">TODO: out of laziness, target variable must always be last.</span>
data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Low Price'</span><span style="color:#808030; ">]</span> <span style="color:#808030; ">=</span> np<span style="color:#808030; ">.</span>where<span style="color:#808030; ">(</span>data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Price (OOS)'</span><span style="color:#808030; ">]</span> <span style="color:#44aadd; ">&lt;</span> split_price<span style="color:#808030; ">,</span> <span style="color:#0000e6; ">'positive'</span><span style="color:#808030; ">,</span> <span style="color:#0000e6; ">'negative'</span><span style="color:#808030; ">)</span>
<span style="color:#800000; font-weight:bold; ">del</span> data<span style="color:#808030; ">[</span><span style="color:#0000e6; ">'Price (OOS)'</span><span style="color:#808030; ">]</span>

<span style="color:#696969; ">#data = data.sample(frac=0.5) #half the number of samples for timing analysis</span>

<span style="color:#696969; ">#Here we print our intermediate result</span>
data<span style="color:#808030; ">.</span>to_csv<span style="color:#808030; ">(</span><span style="color:#0000e6; ">'IPEDS_Clean_Normalized.csv'</span><span style="color:#808030; ">,</span>index<span style="color:#808030; ">=</span><span style="color:#074726; ">False</span><span style="color:#808030; ">)</span>

<span style="color:#696969; ">#And split into train/test cases (10-fold cross-validation, 30% training set)</span>
<span style="color:#800000; font-weight:bold; ">for</span> i <span style="color:#800000; font-weight:bold; ">in</span> <span style="color:#400000; ">range</span><span style="color:#808030; ">(</span><span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span> num_cross_validations<span style="color:#44aadd; ">+</span><span style="color:#008c00; ">1</span><span style="color:#808030; ">)</span><span style="color:#808030; ">:</span>
    train <span style="color:#808030; ">=</span> data<span style="color:#808030; ">.</span>sample<span style="color:#808030; ">(</span>frac<span style="color:#808030; ">=</span>training_set<span style="color:#808030; ">)</span>
    test <span style="color:#808030; ">=</span> data<span style="color:#808030; ">.</span>drop<span style="color:#808030; ">(</span>train<span style="color:#808030; ">.</span>index<span style="color:#808030; ">)</span>
    train<span style="color:#808030; ">.</span>to_csv<span style="color:#808030; ">(</span><span style="color:#0000e6; ">'IPEDS_Train_'</span><span style="color:#44aadd; ">+</span><span style="color:#400000; ">str</span><span style="color:#808030; ">(</span>i<span style="color:#808030; ">)</span><span style="color:#44aadd; ">+</span><span style="color:#0000e6; ">'.csv'</span><span style="color:#808030; ">,</span>index<span style="color:#808030; ">=</span><span style="color:#074726; ">False</span><span style="color:#808030; ">)</span>
    test<span style="color:#808030; ">.</span>to_csv<span style="color:#808030; ">(</span><span style="color:#0000e6; ">'IPEDS_Test_'</span><span style="color:#44aadd; ">+</span><span style="color:#400000; ">str</span><span style="color:#808030; ">(</span>i<span style="color:#808030; ">)</span><span style="color:#44aadd; ">+</span><span style="color:#0000e6; ">'.csv'</span><span style="color:#808030; ">,</span>index<span style="color:#808030; ">=</span><span style="color:#074726; ">False</span><span style="color:#808030; ">)</span>
</pre>
